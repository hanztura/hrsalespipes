{% extends "contacts/base.html" %}

{% block title %}
Client Detail - {{ object.name }}
{% endblock title %}

{% block subcontent %}
  <v-container
    fluid>
    <h1>{{ object.name }} - Client Detail</h1>
    <p>Industry - <strong>{{ object.industry }}</strong></p>
    <v-row
      align="center"
      justify="center"
    >
      <v-col cols="12" class="text-center">
        <v-tabs
          v-model="tab"
          fixed-tabs>

          {% include "_includes/v_tab.html" %}

          <v-tabs-items v-model="tab">
            <v-tab-item id="Contact Details" eager>
              <v-simple-table
                dense>
                <table>
                  <tbody>
                    <tr>
                      <th>Contact Number:</th>
                      <td>{{ object.contact_number }}</td>
                    </tr>
                    <tr>
                      <th>Alternate Contact Number:</th>
                      <td>{{ object.alternate_contact_number }}</td>
                    </tr>
                    <tr>
                      <th>Email Address:</th>
                      <td><a href="mailto:{{ object.email_address }}">{{ object.email_address }}</a></td>
                    </tr>
                    <tr>
                      <th>Whatsapp Link:</th>
                      <td>
                        {% if object.whatsapp_link %}
                          <a href="{{ object.whatsapp_link }}">Click here to send WhatsApp Message</a>
                        {% endif %}
                      </td>
                    </tr>
                    <tr>
                      <th>Skype ID:</th>
                      <td>{{ object.skype_id }}</td>
                    </tr>
                    <tr>
                      <th>MS Teams ID:</th>
                      <td>{{ object.ms_teams_id }}</td>
                    </tr>
                    <tr>
                      <th>Location:</th>
                      <td>{{ object.location }}</td>
                    </tr>
                  </tbody>
                </table>
              </v-simple-table>
            </v-tab-item>

            <v-tab-item id="Others" eager>
              <v-simple-table>
                <table>
                  <tbody>
                    <tr>
                      <th>Initial Approach:</th>
                      <td>{{ object.initial_approach }}</td>
                    </tr>
                    <tr>
                      <th>Meeting Arranged:</th>
                      <td>{{ object.meeting_arranged }}</td>
                    </tr>
                    <tr>
                      <th>Agreement Terms:</th>
                      <td>{{ object.agreement_term }}</td>
                    </tr>
                    <tr>
                      <th>Agreement Fee:</th>
                      <td>{{ object.agreement_fee }}</td>
                    </tr>
                    <tr>
                      <th>Refund Scheme:</th>
                      <td>{{ object.refund_scheme }}</td>
                    </tr>
                    <tr>
                      <th>Validity:</th>
                      <td>{{ object.validity }}</td>
                    </tr>
                    <tr>
                      <th>Point of Contacts:</th>
                      <td v-if="pointOfContacts.length">
                        <v-simple-table dense>
                          <table>
                            <thead>
                              <tr>
                                <th class="text-center">Name</th>
                                <th class="text-center">Number</th>
                                <th class="text-center">Email</th>
                                <th class="text-center">Notes</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                v-for="(contact, index) in pointOfContacts"
                                :key="index">
                                <td>[[ contact.name ]]</td>
                                <td>[[ contact.number ]]</td>
                                <td>[[ contact.email ]]</td>
                                <td>[[ contact.notes ]]</td>
                              </tr>
                            </tbody>
                          </table>
                        </v-simple-table>
                      </td>
                      <td v-else>None</td>
                    </tr>
                  </tbody>
                </table>
              </v-simple-table>
              <input type="hidden" ref="pointOfContacts" value='{{ object.point_of_contacts }}'>
            </v-tab-item>
          </v-tabs-items>
        </v-tabs>
      </v-col>
      
      <v-col cols="12" class="text-center">
        <v-btn
          block
          color="primary"
          href="{% url 'contacts:clients_edit' object.pk %}">Edit</v-btn>
      </v-col>
    </v-row>
  </v-container>  
{% endblock subcontent %}

{% block script %}
<script>
  new Vue({
    el: '#inspire',
    vuetify: new Vuetify(),
    delimiters: ['[[', ']]'],

    props: {
      source: String,
    },

    data: () => ({
      drawer: null,
      breadcrumbs: [
        {
          text: 'Dashboard',
          disabled: false,
          href: '/',
        },
        {
          text: 'Contacts',
          disabled: false,
          href: '{% url "contacts:index" %}',
        },
        {
          text: 'Clients',
          disabled: false,
          href: '{% url "contacts:clients_list" %}',
        },
        {
          text: '{{ object.name }}',
          disabled: true,
        },
      ],
      tab: null,
      tabs: [
        {
          tab: 'Contact Details',
          icon: 'fas fa-address-book',  
        },
        {
          tab: 'Others',
          icon: 'fas fa-info',  
        },
      ],
      pointOfContacts: [],
    }),

    methods: {
      setPointOfContacts: function() {
        let poc = this.$refs.pointOfContacts.value;
        poc = poc ? JSON.parse(poc) : [];
        this.pointOfContacts = poc;
      },
    },

    mounted(){
      this.setPointOfContacts();
    }

  });
</script>  
{% endblock script %}